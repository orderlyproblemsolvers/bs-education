import{m as t,d as e}from"./server.mjs";const useBlog=()=>{const r=t();e();const convertToWebP=async t=>new Promise((e,r)=>{const o=(void 0).createElement("canvas"),a=o.getContext("2d"),s=new Image;s.onload=()=>{o.width=s.width,o.height=s.height,a.drawImage(s,0,0),o.toBlob(o=>{o?e(new File([o],t.name.split(".")[0]+".webp",{type:"image/webp"})):r(new Error("Failed to convert image"))},"image/webp",.8)},s.onerror=()=>r(new Error("Failed to load image")),s.src=URL.createObjectURL(t)});return{convertToWebP:convertToWebP,uploadImage:async t=>{try{const e=await convertToWebP(t),o=`${Date.now()}-${e.name}`,{data:a,error:s}=await r.storage.from("blog-images").upload(o,e);if(s)throw s;const{data:{publicUrl:c}}=r.storage.from("blog-images").getPublicUrl(o);return c}catch(t){throw t}},createBlogPost:async t=>{try{const{data:e,error:o}=await r.from("blog_posts").insert([t]).select();if(o)throw o;return e[0]}catch(t){throw t}},getAllBlogPosts:async()=>{try{const{data:t,error:e}=await r.from("blog_posts").select("*").order("created_at",{ascending:!1});if(e)throw e;return t}catch(t){throw t}},getRecentBlogPosts:async(t=3)=>{try{const{data:e,error:o}=await r.from("blog_posts").select("*").order("created_at",{ascending:!1}).limit(t);if(o)throw o;return e}catch(t){throw t}},getBlogPost:async t=>{try{const{data:e,error:o}=await r.from("blog_posts").select("*").eq("id",t).single();if(o)throw o;return e}catch(t){throw t}},updateBlogPost:async(t,e)=>{try{const{data:o,error:a}=await r.from("blog_posts").update({...e,updated_at:(new Date).toISOString()}).eq("id",t).select();if(a)throw a;return o[0]}catch(t){throw t}},deleteBlogPost:async t=>{try{const{error:e}=await r.from("blog_posts").delete().eq("id",t);if(e)throw e;return!0}catch(t){throw t}}}};export{useBlog as u};
//# sourceMappingURL=useBlog-vfFypdLf.mjs.map
